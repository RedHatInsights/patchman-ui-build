(self.webpackChunk_redhat_cloud_services_frontend_components_inventory_patchman=self.webpackChunk_redhat_cloud_services_frontend_components_inventory_patchman||[]).push([[743],{78970:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>M});var r=n(85061),o=n(96156),s=n(92137),i=n(28481),c=n(87757),a=n.n(c),l=n(32895),u=n(59505),f=n(72573),m=n(86350),p=n(20167),S=n(35240),y=n(33739),d=n(77865),b=n.n(d),g=n(61084),h=n(60578),v=n(28725),_=n(87145),O=n(26143),k=n(55949),Z=n(75835),E=n(76923),w=n(48527),P=n(2558),j=n(49736),C=n(22347),D=n(96928),L=n(45168),T=n(28961),F=n(14030);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const M=function(){var e=D.N.formatMessage(h.Z.titlesSystems);(0,C.Iw)(e);var t=(0,g.useDispatch)(),n=b().useState(!1),o=(0,i.Z)(n,2),c=o[0],d=o[1],N=b().useState((function(){return function(){return null}})),M=(0,i.Z)(N,2),W=M[0],q=M[1],x=(0,g.useSelector)((function(e){return e.SystemsListStore.rows})),A=(0,g.useSelector)((function(e){return e.SystemsListStore.selectedRows})),R=b().useMemo((function(){return(0,P.Yk)(x,A)}),[x]),z=(0,g.useSelector)((function(e){return e.SystemsListStore.status})),H=(0,g.useSelector)((function(e){return e.SystemsListStore.metadata})),K=(0,g.useSelector)((function(e){return e.SystemsListStore.queryParams})),Q=(0,g.useSelector)((function(e){var t=e.entities;return t&&t.columns})),V=K.filter,Y=K.search,B=(0,C.W5)(H,te);(0,C.KW)((function(){t((0,k.ZX)(K))}),[K]);var J=(0,C.T8)(H.limit,H.offset),U=(0,i.Z)(J,2),X=U[0],G=U[1];function $(e){return ee.apply(this,arguments)}function ee(){return(ee=(0,s.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.next=3,t;case 3:n=e.sent,q((function(){return function(){return b().createElement(T.Z,{data:n})}})),d(!1);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e){t((0,k.PH)(e))}var ne=(0,C.j5)(V,te),re=(0,i.Z)(ne,1)[0],oe={items:[(0,v.Z)(te,Y,D.N.formatMessage(h.Z.labelsFiltersSystemsSearchTitle),D.N.formatMessage(h.Z.labelsFiltersSystemsSearchPlaceholder))]},se={filters:(0,j.mt)(V,Y),onDelete:re},ie=function(){var e=Q&&Q.filter((function(e){return"updated"===e.key}))[0];return e=I(I({},e),{},{key:"last_upload"}),[].concat((0,r.Z)(F.Fs),[e])},ce=(0,C.ry)(R,A,(function(){return(0,E.lc)(I(I({},K),{},{limit:-1}))}),(function(e){t({type:"SELECT_ENTITY",payload:e})})),ae=(0,C._f)(ie(),te,1),le=b().useMemo((function(){return(0,j.hO)(ie(),H.sort,1)}),[H.sort]),ue=A&&(0,j.Qy)(A).length,fe=function(e){return(0,E.ob)({limit:-1}).then((function(t){var n=t.data;return(0,E.fq)({advisories:n.map((function(e){return e.id})),systems:e})}))};return b().createElement(b().Fragment,null,b().createElement(_.Z,{title:D.N.formatMessage(h.Z.titlesPatchSystems),headerOUIA:"systems"}),b().createElement(W,null),b().createElement(m.Z,null,z===w.g_?b().createElement(p.Z,null):b().createElement(y.Z,{onLoad:function(e){var t=e.mergeWithEntities,n=(0,O.b)();(0,O.z)(I({},t((0,Z.Kq)(F.Fs,n.getState().SystemsListStore))))},isFullView:!0,items:R,page:X,total:H.total_items,perPage:G,isLoaded:z===w.Wd,onRefresh:B,exportConfig:{isDisabled:0===H.total_items,onSelect:function(e,t){var n=(new Date).toISOString().replace(/[T:]/g,"-").split(".")[0]+"-utc",r="systems-".concat(n);"csv"===t?(0,E.wI)(K).then((function(e){return(0,S.Sv)(e,r,"csv")})):(0,E.TW)(K).then((function(e){return(0,S.Sv)(JSON.stringify(e),r,"json")}))}},bulkSelect:ce&&{count:ue,items:[{title:"Select none (0)",onClick:function(){ce("none")}},{title:"Select page (".concat(R.length,")"),onClick:function(){ce("page")}},{title:"Select all (".concat(H.total_items,")"),onClick:function(){ce("all")}}],onSelect:function(e){ce(e?"all":"none")},toggleProps:{"data-ouia-component-type":"bulk-select-toggle-button"},checked:0!==ue&&(ue===H.total_items||null),isDisabled:0===H.total_items&&0===ue},actions:(0,F.Sb)($),filterConfig:oe,activeFiltersConfig:se,tableProps:{areActionsDisabled:function(e){return e.applicable_advisories.every((function(e){return 0===e}))},onSort:H.total_items&&ae,sortBy:H.total_items&&le,canSelectAll:!1,variant:f.TableVariant.compact,className:"patchCompactInventory",isStickyHeader:!0}},b().createElement(l.ki,null,b().createElement(u.Eg,null,b().createElement(L.Z,{onClick:function(){return $((0,j.Sz)(Object.keys(A).filter((function(e){return A[e]})),fe,j.R9))},isDisabled:0===(0,j.Qy)(A).length||c,isLoading:c,ouia:"toolbar-remediation-button"}))))))}}}]);